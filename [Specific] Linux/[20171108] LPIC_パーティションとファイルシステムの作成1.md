# 5.1 パーティションとファイルシステムの作成

# 5.1.1 ハードディスク

デバイスファイル
：ハードディスクやCD-ROM、シリアルポートといったデバイスの入出力を扱うための特殊なファイル。

- /dev/sda~sdd 1~4番目のハードディスク
- /dev/sr0 1番目のCD/DVDドライブ 
- /dev/st0 1番目のテープドライブ

# 5.1.2 パーティションの種類

拡張パーティション

：基本パーティションの一つを拡張パーティションにすることができる。拡張パーティションの中にはファイルシステムではなく、論理パーティションが格納される

論理パーティション

：論理パーティションとは、拡張パーティション内に作成されたパーティションのこと

# 5.1.3 ルートファイルシステム

/ディレクトリを含むファイルシステムがルートファイルシステム

マウント
：ファイルシステム内のディレクトリツリーを、特定のディレクトリ以下に結合することをマウントという

# 5.1.4 パーティション管理コマンド

`fdisk`

-lオプションを指定すると、そのデバイス（ハードディスク）のパーティションテーブルの状態を表示

- n : パーティションを作成
- p : パーティションテーブルを表示
- t : パーミッションタイプを変更

`gdisk`

GPTでは2TBの制限はなくなり、パーティションも最大128個まで作成できる

`parted`

：MBRにもGPTにも対応したパーティション操作コマンド

-　mklabel [gpt|msdos] 新しいパーティションテーブルを作成
-　mkpart 指定した種別のパーティションを作成

: fdisk, gdiskはパーティション操作後wコマンドで書き込みをすることで、初めてパーティションテーブルに反映されるが、partedコマンドでは即時にパーティションテーブルに反映される

# 5.1.5 ファイルシステムの作成

ファイルシステム
: ファイルとしてディスク上のデータを扱う仕組み

ファイルシステムではブロックという単位でデータを保存し管理
linuxのファイルシステムでは、「ファイルの中身（データ）」と「ファイルの属性や管理情報」は別々に保存されている。後者を格納しているのがi-node（indexノード）と呼ばれる管理領域


`mkfs`

：パーティション上にファイルシステムを作成
ファイルシステムの種類に対応したコマンドを呼び出し

- -t ファイルシステムタイプ　ファイルシステムの種別を指定する

```
$ mkfs -t ext4 /dev/sdb1
```

# 5.2 ファイルシステムの管理

#5.2.1ディスクの利用状況の確認

`df`

ファイルシステムの空き容量は、dfコマンドで確認。i-ノードが枯渇してしまうと、ディスクに空き容量があったとしてもファイルを新規に保存することができなくなる。 iノードの使用状況を確認するには、dfコマンドにiオプションを付ける

`du`

ファイルやディレクトリが占めている容量を表示するには、duコマンドを使う

[option]
- -a ディレクトリ以外にファイルについても表示
- -l リンクも含めて集計する
- -c 全ての容量の合計を表示する
- -m 容量をmb単位で表示する

# 5.2.2 ファイルシステムのチェック

`fsck`

ディスクのチェックを行い、必要であれば修復を試みることができる


[option]

- -a 自動的に修復を実行
- -r 対話的に修復を実行
- -N 実際には実行せず何が行われるかのみ表示

ext2, ext3, ext4ファイルシステムのチェックの修復にはe2fsckを使う。

[option]

- -p 全ての不良ブロックを自動的に修復する

# 5.2.3 ファイルシステムの管理

`tune2fs`

: ext2,ext3,ext4ファイルシステムの様々なパラメータを設定

- -j ext2ファイルシステムをext3ファイルシステムに変換する
- -L ファイルシステムのボリュームラベルを設定する

`dump2fs`

ファイルシステムの各種情報を表示することができる

# 5.2.4 XFS

：ジャーナリングファイルシステムの一種。ファイルシステムの操作をジャーナル（ログ）に記録する仕組みを備えたファイルシステム

- mkfs.xfs :XFSファイルシステムの作成 
- xfs_db：XFSファイルシステムのデバックを実行
- xfs_admin：XFSファイルシステムのパラメータを変更
- xfs_fsr：XFSファイルシステムのデフラグを実行


