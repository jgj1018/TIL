# 10.1 システムクロックの設定

# 10.1.1 システムロックとハードウェアクロック

コンピュータにはハードウェアとして内蔵された時計が組み込まれており、ハードウェアクロックという。一方、Linuxのカーネル内に存在する時計がある。これがシステムクロック。システムクロックは、Linux起動時にハードウェアクロックを参照して設定。

`data`

システムクロックを参照して現在の日時が表示される。

書式： data [MMDDhhmm[CC]YY[.ss]]

rootユーザーはdataコマンドを使ってシステムクロックを変更できる。

```
# data 022317002015 // 2015/2/23/17時
```

ex)

```
$ tar czf `data "+%Y%m%d"' .tar.gz /data
```

dataコマンドで設定したシステムクロックをハードウェアクロックにセットするコマンドがhwclock.

`hwclock`

- -r ハードウェアクロックを表示
- -w システムクロックの時刻をハードウェアクロックに設定
- -s ハードウェアクロックの時刻をシステムクロックに設定

# 10.1.2 NTPによる時刻設定

正確な時刻を設定するには、ネットワーク経由でクロックを同期するプロトコルであるNTP(Network Time Protocol)を使い、インターネット上にあるNTPサーバから正確な時刻を取得する。 `ntpudate`を使って、NTPサーバから正確な時刻を取得する。

NTPサーバtime.server.lpic.jpから現在時刻を取得している。

```
ntpupdate time.server.lpic.jp
```

NPTサーバを自前で運用することもできる。SysVinitを採用したシステムでは、NTPサーバは次のようにして起動する。

```
#/etc/init.d/ntpd start
```

systemdを採用したシステムでは以下

```
# systemctl start ntpd.service
```

`ntpd`コマンドを使うと、NTPサーバの状態を照会することができる。
localhostで稼働しているNTPサーバから問い合わせされているNTPサーバのリスト。

```
#ntpd -p localhost
```

